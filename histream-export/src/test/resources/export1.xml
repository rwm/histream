<?xml version="1.0" encoding="UTF-8"?>
<export xmlns="http://sekmi.de/ns/histream/export">
	<patient>
		<column header="pid" type="id"/>
		<column header="seq" type="sequence">
			<id>seq1</id>
		</column>
	</patient>
	<visit>
		<column header="pid" type="patient-ref"/>
		<column header="visit" type="id"/>
		<!-- concepts for the visit table must occur only once
		per visit and may not repeat -->
		<column header="start" type="attribute">
			<property>start</property>
		</column>
		<!-- What is better? -->
		<!-- (a) First column, then concepts with value -->
		<column header="diagnostik_labort_ts" na="NULL" type="fact">
			<concept code="LOINC:26436-6"/>
			<concept code="LOINC:26436-6:NEG"/>
			<value type="script">
					<eval>fact.conceptId.substring(6)</eval>
			</value>
		</column>
		<!-- (b) first concepts then columns with value -->
		<group>
			<concept code="LOINC:26436-6"/>
			<concept code="LOINC:26436-6:NEG"/>
			<column header="lab_ts" type="attribute">
				<attribute>start</attribute>
			</column>
			<!-- We want this: 
					6:NEG -> not tested
					6/mod=OPB -> tested non pathological
					6/mod=PB -> tested pathological 
			-->
			<column header="lab_ergebnis" type="attribute">
				<modifier>PB</modifier>
				<attribute>start</attribute>
			</column>
		</group>
	</visit>
	<table id="diagnosen">
		<!-- makes more sense for fact tables to specify
			the list of concepts first. -->
		<concept wildcard="ICD10:*"/>
		<concept code="ICD9:123"/>
		<column header="pid" type="patient-ref"/>
		<column header="visit" type="visit-ref"/>
		<column header="start" type="attribute">
			<attribute>start</attribute>
		</column>
		<column header="primary" type="attribute" na="nein">
			<modifier>fuehrend</modifier>
			<!-- if a modifier element is provided, the property
			 will use the context of that modifier -->
			<constant-value>ja</constant-value>
		</column>
		<column header="text" type="attribute">
			<modifier>originalText</modifier>
			<property>value</property>
		</column>
		<!-- reference sequence from patient -->
		<column header="seq1" type="sequence">
			<sequence ref="seq1"/>
		</column>
	</table>
</export>